# Feature Specification: プレゼンテーション・タイマー

**Feature Branch**: `001-presentation-timer`
**Created**: 2025-10-16
**Status**: Draft
**Input**: User description: "プレゼンテーションで、タイムキーパーをすることになりました。プレゼンテーションしている人に対して、残り時間をリアルタイムで案内したいです。残り時間は、利用者が任意に設定できます。残り時間は、画面に大きく表示したいです。残り時間が1分前になったときや、0秒になったとき、音を鳴らしたいです。音を鳴らす時間は、利用者が任意に設定できます。残り時間が0秒より小さくなったとき、赤色でマイナス表示をしたいです。一時停止、リセット、リスタートも簡単にできるようにします。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 基本的なタイマー操作と表示 (Priority: P1)

タイムキーパーが、プレゼンテーション開始前に時間を設定し、プレゼンテーション中に残り時間を大きく表示して視認しながら、必要に応じてタイマーを制御できる。

**Why this priority**: これが最もコアな機能であり、これだけでも基本的なタイムキーパーとしての価値を提供できます。時間設定、表示、基本的な制御（開始・停止・リセット）があれば、最小限の機能として成立します。

**Independent Test**: 任意の時間（例：5分）を設定し、タイマーを開始して画面に大きく表示されることを確認し、一時停止・再開・リセットが正しく動作することをテストできます。

**Acceptance Scenarios**:

1. **Given** タイムキーパーがアプリケーションを開いた状態、**When** 時間設定画面で「10分」を入力してタイマーを開始する、**Then** 画面に「10:00」が大きく表示され、1秒ごとにカウントダウンが始まる
2. **Given** タイマーが「7:30」でカウントダウン中、**When** 一時停止ボタンを押す、**Then** タイマーが「7:30」で停止し、カウントダウンが止まる
3. **Given** タイマーが一時停止中、**When** 再開ボタンを押す、**Then** 停止していた時間からカウントダウンが再開される
4. **Given** タイマーがカウントダウン中または停止中、**When** リセットボタンを押す、**Then** タイマーが初期設定時間（例：10:00）に戻る

---

### User Story 2 - 時間経過後のマイナス表示 (Priority: P2)

プレゼンテーションが予定時間を超過した場合、タイムキーパーは超過時間を視覚的に認識できる。

**Why this priority**: 予定時間を超過した場合の対応は重要ですが、基本的なタイマー機能があれば0秒で気づくことができます。視覚的なフィードバック（赤色表示とマイナス表示）は、ユーザー体験を向上させる追加価値です。

**Independent Test**: タイマーを「0:03」などの短い時間に設定し、0秒を経過した後も動作を継続させ、マイナス表示（例：「-0:05」）が赤色で表示されることを確認できます。

**Acceptance Scenarios**:

1. **Given** タイマーが「0:02」でカウントダウン中、**When** 時間が「0:00」を経過して「-0:01」になる、**Then** 表示が赤色に変わり「-0:01」と表示される
2. **Given** タイマーが「-1:30」を表示中、**When** さらに時間が経過する、**Then** 赤色のまま「-1:31」「-1:32」と継続してカウントダウン（マイナス方向へのカウントアップ）が続く
3. **Given** タイマーが「-0:45」で赤色表示中、**When** リセットボタンを押す、**Then** タイマーが初期設定時間に戻り、表示色が通常色（黒または白）に戻る

---

### User Story 3 - アラート音の設定と再生 (Priority: P3)

タイムキーパーは、特定のタイミング（例：残り1分、0秒到達時）で音声アラートを設定し、プレゼンテーション中に音で時間を知らせることができる。

**Why this priority**: アラート音は便利な機能ですが、視覚的な表示があれば基本的なタイムキーパーの役割は果たせます。音声通知は、タイムキーパーが画面から目を離している場合の補助機能として価値があります。

**Independent Test**: タイマーに複数のアラートポイント（例：1分前、0秒）を設定し、それぞれのタイミングで音が鳴ることを確認できます。また、アラート設定を変更（例：30秒前を追加）して、カスタマイズが正しく反映されることをテストできます。

**Acceptance Scenarios**:

1. **Given** タイムキーパーがアラート設定画面を開いた状態、**When** 「残り1分」と「0秒到達時」にアラートを設定する、**Then** 設定が保存され、タイマー動作時に該当タイミングでアラートが有効になる
2. **Given** アラート設定で「残り1分」と「0秒到達時」が有効な状態でタイマーが動作中、**When** タイマーが「1:00」に到達する、**Then** アラート音が再生される
3. **Given** アラート設定で「残り1分」と「0秒到達時」が有効な状態でタイマーが動作中、**When** タイマーが「0:00」に到達する、**Then** アラート音が再生される
4. **Given** タイムキーパーがアラート設定画面を開いた状態、**When** 「残り30秒」を新しいアラートポイントとして追加する、**Then** 設定が保存され、タイマーが「0:30」に到達したときにアラートが鳴る
5. **Given** タイマーが一時停止中、**When** 一時停止中に本来アラートが鳴るタイミング（例：1:00）を過ぎている、**Then** 一時停止中はアラートが鳴らない

---

### Edge Cases

- タイマーが0秒に到達し、マイナス表示に切り替わる瞬間に一時停止した場合、再開後も正しくマイナス方向へカウントが進むか？
- アラート音が鳴っている最中にリセットボタンを押した場合、音は即座に停止するか？
- 極端に長い時間（例：99時間59分）を設定した場合、表示は正しく動作するか？
- 複数のアラートポイントが設定されており、一時停止中に複数のアラートタイミングを跨いだ場合、再開後にすべてのアラートが一度に鳴ることはないか？
- タイマー動作中にアラート設定を変更した場合、変更は即座に反映されるか、それとも次回のタイマー起動時から反映されるか？
- 0秒を設定してタイマーを開始した場合、即座にマイナス表示に切り替わるか、それとも1秒間「0:00」を表示するか？
- ブラウザのタブが非アクティブになった場合でも、タイマーとアラートは正確に動作するか？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは、利用者が任意の時間（分・秒単位）を設定できる機能を提供しなければならない
- **FR-002**: システムは、設定された時間から1秒ごとにカウントダウンを行い、残り時間をリアルタイムで表示しなければならない
- **FR-003**: システムは、残り時間を画面上に大きく、明瞭に表示しなければならない（プレゼンテーション会場で遠くからでも視認可能なサイズ）
- **FR-004**: 利用者は、タイマーを一時停止できなければならない
- **FR-005**: 利用者は、一時停止したタイマーを再開（リスタート）できなければならない
- **FR-006**: 利用者は、タイマーをリセットして初期設定時間に戻すことができなければならない
- **FR-007**: システムは、残り時間が0秒より小さくなった場合、マイナスの時間を赤色で表示しなければならない
- **FR-008**: 利用者は、複数のタイミング（例：残り1分、0秒到達時）でアラート音を鳴らす設定ができなければならない
- **FR-009**: システムは、設定されたアラートタイミングに到達した際、音声通知を再生しなければならない
- **FR-010**: 利用者は、アラート音を鳴らすタイミングを自由に追加・削除できなければならない
- **FR-011**: タイマーが一時停止中の場合、アラート音は鳴らないようにしなければならない
- **FR-012**: 利用者がリセットボタンを押した場合、タイマーは設定された初期時間に即座に戻らなければならない
- **FR-013**: システムは、マイナス時間表示の際も継続してカウントを進めなければならない（例：-0:01、-0:02、-0:03...）

### Key Entities

- **タイマー設定**: 利用者が設定する初期時間（分・秒）、現在の残り時間、タイマーの状態（停止中・動作中・一時停止中）
- **アラートポイント**: 利用者が設定する音声通知のタイミング（例：残り60秒、0秒）、アラート音の再生状態

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 利用者は、タイマーの初期設定から開始までを30秒以内に完了できる
- **SC-002**: タイマーの表示サイズは、3メートル離れた位置からでも残り時間を明瞭に読み取れる
- **SC-003**: タイマーのカウントダウンは、実時間との誤差が1秒以内である
- **SC-004**: 一時停止・再開・リセットの各操作は、ボタンを押してから0.5秒以内に反映される
- **SC-005**: アラート音は、設定されたタイミングから1秒以内に再生される
- **SC-006**: マイナス時間への切り替えは、0秒到達と同時（1秒以内の遅延）に赤色表示に変わる
- **SC-007**: 利用者の90%以上が、初回利用時にマニュアルなしで基本操作（時間設定・開始・停止・リセット）を完了できる

